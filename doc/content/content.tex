\section{Introductory remarks}
This report\footnote{Text taken from \cite{REF-00014}.} is devoted to a derivation of an algorithmic method to design $m$-phase symmetrical windings and a representation thereof in a compact form. The basic principle of the winding of an electrical machine is to obtain a rotating magnetic field in the stator (the stationary part) that interacts with the moving part (the rotor). This is achieved by arranging the coils of the winding in the stator slots around the air gap periphery in such a way that a rotating field is developed when applying currents. As a result the induced voltage, which arises from flux per pole $\hat{\Phi}$, is obtained from Faraday's law. In general the sinusoidally induced voltage for a winding having $N_s$ series turns per phase is
\begin{equation}
  \label{eqn:ui}
  U_i = \sqrt{2} \pi f_1 \xi_p N_s \hat{\Phi}, \qquad \xi_p \leq 1
\end{equation}
where $\xi_p$ is the winding factor of the \textit{working harmonic}. The induced voltage in \eqref{eqn:ui} brings the importance of the winding design to the fore. For a given design requirement, it is desirable to have $\xi_p$ as high as possible.

\section{Notes to the reader}
A Matlab script that implements the algorithm in Fig.~\ref{fig:flowchart} is used to plot the examples given in Tab.~\ref{tab:Example_table}. The complete program listings are given in \ref{sec:malg} and \ref{sec:mex}. Start the script by typing from the Matlab promt:

\begin{lstlisting}[language=matlab]
wnd = arun(1);
\end{lstlisting}
The resulting plots are shown in Fig.~\ref{fig:tests} and the Matlab code is provided in appendix \ref{sec:mex}.

\section{Definition of the working harmonic}\label{sec:working_harmonic}
Throughout the analysis all harmonics are referred to in terms of the bore $2\pi$ of the machine, i.e.~the \textit{fundamental harmonic} has the order $\nu=1$ and forms one pole pair. The harmonic that produces the magnetic field that interacts with the rotor poles $2p$ has the order $\nu=p$ and is called the \textit{working harmonic}. Any other harmonic of the $\nu^{th}$ order will have $\nu$ pole pairs and spans a peripheral angle of $\frac{2\pi}{\nu}$.

Often the harmonic orders are normalised with respect to the \textit{working harmonic}, i.e.~$\xi_{\nu /p}$. This then means that the \textit{working harmonic} is written as $\xi_1$ and sub-harmonics will have a fraction as subscript. This notation will not be used in this report.

\section{Classification of symmetrical windings}%
\label{sec:m_phases}
The winding design can be quite a difficult task and at this point it is useful to have a coarse classification of symmetrical windings. Since symmetrical windings comprise such a great variety, an attempt to categorise them will depend on the properties by which they are to be sorted. 

\subsection{Slots and coils per pole and phase} \label{subsec:slots_coils}
Any $m$-phase winding could be characterised by its number of slots per pole and phase. However, when comparing different winding designs with each other this number alone is insufficient. It does not take into account the number of layers the winding has. In addition, the number of coils per pole and phase should be defined. For a machine with $Q_s$ stator slots, $p$ pole pairs and $m$ phases the following definitions holds:
\begin{defth}
Slots per pole and phase: 
\begin{equation}
  q =\frac{Q_{s}}{m2p}=\frac{q_{n}}{q_{d}}
\end{equation}
$\frac{q_{n}}{q_{d}}$ is the reduced form of $q$. Each phase has $q_n$ slots that are distributed over $q_d$ poles. In the case where $q_d$ equals one, $q$ is an integer and the winding is called an integer slot winding. When $q_d$ is greater than one, it is called a fractional slot winding. 
\end{defth}
\begin{defth}
Coils per pole and phase: 
\begin{equation}
  q_{c}=\frac{Q_{c}}{m2p}=\frac{q_{c_n}}{q_{c_d}}
\end{equation}
$\frac{q_{c_n}}{q_{c_d}}$ is the reduced form of $q_c$. Each phase has $q_{c_n}$ coils distributed over $q_{c_d}$ poles. If $q_{c_n}$ is greater than one and $q_c$ is not equal to one it is a distributed winding. 
\end{defth}
These characteristic numbers give useful information on the winding when they are written as a reduced improper fraction\footnote{The reduced fraction could be either a proper or an improper fraction. An improper fraction has the numerator greater than the denominator.}. Additionally, the properties of single and double layer windings are summerised in Tab.~\ref{tab:properties_single_double}. 

{\renewcommand{\arraystretch}{1.2}
\begin{table}[htbp]
	\caption{Winding properties}
	\label{tab:properties_single_double}
  \centering
  \begin{tabular}{|c|c|}
  \hline
	single layer winding & double layer winding \\
	\hline
	$q = 2q_c$ & $q = q_c$ \\
	$Q_s = 2Q_c$ &  $Q_s = Q_c$ \\
	\hline
	\end{tabular}
\end{table}}

\subsection{Average coil pitch}
The coil pitch is defined as the peripheral angle between the two coil sides. It is practical to express the coil pitch in terms of the number of slots. Therefore, it is an integer number. 
\begin{defth}
The average coil pitch is defined as
\begin{equation}
  \label{eqn:y_p}
  y_p = \frac{Q_s}{2p}
\end{equation}
and the implemented coil pitch is given by
\begin{equation}
  \label{eqn:y_d}
  y_d = \mbox{int}(y_p)\pm k
  \quad
  \begin{cases}
    k \in \mathbb{N} \\
    y_d \geq 1
  \end{cases}
\end{equation}
\end{defth}
In the case where $y_d=y_p$ it is a full-pitch winding. If $y_d \neq y_p$ it is called a fractional pitch winding. 
 
\subsection{Classification scheme}
The aim of the classification scheme is to find a way to relate different winding types to each other. It is also a useful guideline to compare windings that belong to the same category. For the design methodology offered in this report, the following winding parameters are chosen for the classification:
\begin{enumerate}
	\item the reduced form of the number of coils per pole per phase;
	\item the average coil pitch; and 
	\item the number of layers.
\end{enumerate}
Tab.~\ref{fig:classification} shows a possible way to classify symmetrical $m$-phase windings. The reason for choosing the average coil pitch as a second property arises from the construction of the coils and it is valid for all types of windings. It could be seen as the ideal coil pitch. Additionally, the number of layers is a key parameter since the technology for manufacturing and the material used in single layer windings are different from that used in double layer windings. Using this classification scheme, the following definitions are associated with windings:
\begin{description}
	\item[Distributed winding:] If the numerator $q_{cn}$ of $q_c$ is greater than~%
	one, the winding is distributed. This means that the coil sides are distributed~%
	over $q_{cn}$ slots. The opposite of a distributed winding is a concentrated~%
	winding.
	\item[Concentrated winding:] In the case where $q_{c_n}$ equals one, it is called~%
	a concentrated winding. 
	\item[Concentrated coil:] When $y_d$ equals one, it is a concentrated coil. In~%
	this case the coil is concentrated around a stator tooth.
	a concentrated winding. 
	\item[Single and double layer:] These windings are differentiated by the number~%
	of coils compared to the number of stator slots. In single layer windings the~%
	number of coils equals half the number of stator slots, while for double layer~%
	windings the number of coils is equal to the number of stator slots. In the~%
	present dissertation a double layer winding has two coil sides per slot which could~%
	placed radially in two layers or side by side. 
	\item[Overlapping and non-overlapping:] In overlapping windings the coils overlap~%
	and the coil pitch $y_d$ is greater than one. If the coil pitch $y_d$ equals one,~%
	the coils do not overlap.
	\item[Integral slot winding:] If the denominator $q_d$ equals one, the phase~%
	belt has $q_n$ slots over one pole.
	\item[Fractional slot:] The denominator of $q$ is greater than one. This~%
	means that the $q_n$ slots are distributed over $q_d$ poles. In addition,~%
	the average coil pitch $y_p$ is a fraction. 
\end{description}
{\renewcommand{\arraystretch}{1.2}
\begin{table}[htbp]
  \centering
  \caption{Classification of symmetrical windings}
	\label{fig:classification}
  \begin{tabular}{|l|l|l|}
  \hline
  Parameter  & Constraint  &  Classification  \\
  \hline
  \multirow{2}{*}{$Q_c$} & $\frac{1}{2}Q_s$ & single layer \\
                         & $Q_s$            & double layer \\
  \hline                        
  \multirow{2}{*}{$y_d$} & $=1$  & non-overlapping         \\
                         & $>1$  & overlapping             \\
  \hline                         
  \multirow{2}{*}{$y_d$} & $=y_p$     & full-pitch         \\
                         & $\neq y_p$ & fractional pitch   \\
  \hline                         
  \multirow{2}{*}{$q_d$} & $=1$     & integral slot        \\
                         & $>1$     & fractional slot      \\
  \hline                         
  \multirow{2}{*}{$q_{c_n}$} & $=1$     & concentrated     \\
                             & $>1$     & distributed      \\  
  \hline
  \end{tabular}
\end{table}}

It is important to distinguish between a concentrated winding and a concentrated coil. The classification scheme in Fig.~\ref{fig:classification} defines a concentrated winding in a unique way. Concentrated windings are defined differently in literature. \cite{REF-00814} refers to it as a traditional single layer winding whereas \cite{REF-00822} refers to it as distributed.

Particularly the windings defined as a fractional slot are very attractive for use in permanent magnet synchronous machines. Especially the single layer non-overlapping winding could be used to reduce
\begin{itemize}
	\item manufacturing costs compared to overlapping windings;
	\item the end winding losses;
	\item torque ripple; and
	\item the mutual coupling between the phases.
\end{itemize}

\section{Characteristics of symmetrical windings}
This section contains the major properties by which symmetrical $m$-phase windings are characterised.

\subsection{Basic winding}
\begin{defth}
The smallest repetitive segment is called the basic winding (German: ``Urwicklung'').
\end{defth} 
Due to symmetry only the basic winding needs to be determined. If $q_d$ is less than $p$ the winding is composed of $t$ identical \textit{basic windings}, i.e.
\begin{equation}
  \label{eqn:gcd_t}
  \begin{array}{ll}
  t = \begin{cases}
        \gcd\left(Q_s,p\right)  & \text{for double layer}\\
        \gcd\left(\frac{Q_s}{2},p\right) & \text{for single layer}
      \end{cases}
  \end{array}
\end{equation}
and gcd is called the greatest common divisor. In the case where $t=1$ the winding has no symmetry. Each of the $t$ \textit{basic windings} will have $Q_b$ slots and $p_b$ pole pairs, therefore
\begin{equation}
  \label{eqn:qd_pb}
  Q_b = \frac{Q_s}{t} \quad \mbox{and} \quad p_b = \frac{p}{t} 
\end{equation}
The number $p_b$ is the reduced pole pair. Another way of obtaining this number is by means of the denominator of $q_c$, i.e.
\begin{equation}
  \label{eqn:p_b}
  p_b =  
  \begin{cases}
    \frac{1}{2} q_{c_d}  & q_{c_d} \: \textnormal{even} \\
    q_{c_d}  & q_{c_d} \: \textnormal{odd}
  \end{cases}
\end{equation} 
which is independent of $t$. Examining \eqref{eqn:gcd_t}, it is recognised that $t$ can be rewritten as the gcd between the number of coils and the pole pairs, i.e.
\begin{equation}
  \label{eqn:gcd_t_gcd(Qc_p)}
  t = \gcd(Q_c,p) \quad
  \begin{cases}
    Q_c = Q_s \quad & \textnormal{double layer} \\
    Q_c = \frac{1}{2}Q_s \quad & \textnormal{single layer}
  \end{cases}
\end{equation} 
which is valid for both single and double layer windings. Although $t$ is usually used as a variable for time it is commonly found in literature and will be used in the same way throughout this chapter. Since the winding design is independent of time, it does not cause any confusion.

It is favourable to use the terms ``in and out going coil sides''\footnote{This is similar to the current which is defined as into and out of the page.}. Only the in going coil side needs to be assigned\footnote{The use of coil sides are preferred above coils, since it is then independent whether the coil sides belong to the same coil or not.} since the out going coil side is given by the coil pitch and type of winding.

\subsection{Winding symmetry}
For a winding to be symmetrical the number of coils used in each of the phases must be equal. Therefore the quotient between $Q_c$ and $m$ must be an integer. A requirement for a winding to be symmetrical can be derived from \eqref{eqn:qd_pb}. The symmetry condition can be expressed as
\begin{equation}
  \label{eqn:feasibility}
  \frac{Q_s}{t} = mk, \quad  k \in  \mathbb{N}
\end{equation}
which relates the pole number, number of stator slots and phase number to each other. A very useful function employed in the method is the modulo function which finds the remainder after division, i.e.~ $\textnormal{mod}(a,b)=a-\textnormal{floor}(\frac{a}{b})$\footnote{The floor function of a real number $x$, floor($x$), is a function whose value is the largest integer less than or equal to $x$.}. When using the modulo function it means that $\textnormal{mod}(\frac{Q_s}{t},m)$ must equal zero. There are different ways of deriving the constraints for the winding symmetry condition. Tab.~\ref{tab:feasibility} gives different variations found in the literature to express the symmetry condition. 
{\renewcommand{\arraystretch}{1.6}
\begin{table}[h]
  \caption{Constraints for symmetry}
  \label{tab:feasibility}
  \centering
  \begin{tabular}{|l|l|}
  \hline
  Reference & Constraint \\
  \hline
  \multirow{2}*{\cite{REF-00452}} & $\gcd(q_{c_d},m)=1$  \\
  &$\mbox{mod}\bigl(\frac{Q_c}{q_{c_n}}q_{c_d},m\bigr)=0$\\
  \hline
  \cite{REF-00754} & $\mbox{mod}\bigl(\frac{Q_s}{\gcd(Q_s,2p)},m\bigr)=0$  \\
  \hline
  \cite{REF-00486} & $\mbox{mod}\bigl(\frac{Q_s}{t},m\bigr)=0$ \\
  \hline
  \end{tabular}
\end{table}}

\subsection{Reduced number of pole pairs}
The lowest harmonic generated by a winding is given by $t=\gcd\left(Q_c,p\right)$ and the working harmonic equals $p$. The reduced pole number gives information on the sub-harmonics which are summarised as follows:
\begin{equation}	
 \begin{aligned}
	t &= p \quad \textnormal{the winding has no sub-harmonics} \\
	t &< p \quad \textnormal{the winding has sub-harmonics}
	\end{aligned}
\end{equation} 

The reduced number of pole pairs can be calculated in two different ways. Two greatest common divisors, i.e.~$\gcd\left(Q_c,2\,m\,p\right)$ and $\gcd\left(Q_c,p\right)$, are used to get $q_{c_d}$ and $p_b$ respectively. The relationship between these two factors is as follows:
\begin{equation}
  \label{eqn:reduced_p} 
  \gcd\left(Q_c,p\right)=\frac{\gcd\left(Q_c,2\,m\,p\right)}{r} \hspace{15pt}
  \textnormal{where} \hspace{15pt} r=
  \begin{cases}
	 m  & \text{$q_{c_d}$ even}\\
	 2m & \text{$q_{c_d}$ odd}
  \end{cases}
\end{equation}

\section{Rotating mmf}
Distributing the coils around the air gap periphery firstly requires the winding characteristic as explained in section \ref{subsec:slots_coils} and secondly a constraint assuring that the coils are assigned uniquely to the stator slots. Deriving such a constraint is done by means of the magnetomotive force (mmf) produced by a winding. 

In the theory of three-phase windings the rotating magnetic field is derived from a single coil with $N_t$-turns. The mmf produced by the coil is then written as a Fourier series which allows it to be decomposed in the \textit{working harmonic}, higher order harmonics and sub-harmonics if applicable. A detailed mathematical derivation is given by \cite{REF-01043}. It is also possible to explain the decomposition by means of visualisation as shown in \cite{REF-00004}, \cite{REF-00294} and  \cite{REF-00330}. The visualisation method is preferred and is used in the next sections in order to define the mmf envelope functions. This is necessary to answer the research sub-question which is the mathematical expression that defines a phase belt.

\subsection{The mmf of a single turn coil}%
\label{subsec:nt-turn_coil}
Consider a single coil with $N_t$-turns carrying a current $i$ placed in the stator of a machine with a uniform air gap as shown in Fig.~\ref{fig:mmf_1}(a). Assuming an infinite permeability in the laminated parts, the mmf in the stator and rotor can be neglected. This means the mmf across the air gap will be equal to the total mmf. 
 
\begin{figure}[htbp]
	\centering
  \fontsize{9}{10}\selectfont
	\input{figs/f_mmf_1.tex}
  \caption{Spatial mmf distribution for a $N_t$-turn coil}
  \label{fig:mmf_1}
\end{figure}

The spatial mmf distribution around the air gap periphery is obtained by applying Amp\`ere's law to the contours $C_1$, $C_2$ and $C_3$. The results of the integration are given in \eqref{eqn:int_H}. The integral along $C_1$ is zero since the contour does not enclose any source. Contrary to this the integrals along $C_2$ and $C_3$ equal $N_ti$ and $-N_ti$ respectively. The current in coil side $+1$ is positive, and using the right hand rule, out of the page.  
\begin{equation}
 \label{eqn:int_H}
 \oint \vec{H} \cdot d\vec{l}=
 \begin{cases}
   \begin{array}{llll}
     0  & C_1 & 0 \leq \theta < \frac{\pi}{2} 
     & \Rightarrow H(0)=H(\theta_1)\\
     N_ti & C_2 & \frac{\pi}{2} \leq \theta < \frac{3\pi}{2} 
     & \Rightarrow H(0)-H(\theta_2) = \frac{N_ti}{\delta} \\
     -N_ti & C_3 & \frac{3\pi}{2} \leq \theta < \frac{5\pi}{3} 
     & \Rightarrow H(0)-H(\theta_3) = \frac{N_ti}{\delta}
   \end{array}
 \end{cases}
\end{equation}
Since the flux to and from the rotor are equal, the air gap mmf will have an amplitude of $\frac{N_ti}{2}$. Fig.~\ref{fig:mmf_1}(b) shows the spatial of the single coil. This is a square wave and from the Fourier series the fundamental has an amplitude of $\frac{4}{\pi}$. The fundamental mmf can be seen as the result of a sinusoidally distributed current sheet on the stator inner diameter. When the coil is supplied by a current 
\begin{equation}
  i = \hat{I}\cos\omega t
\end{equation}
any point on the mmf will have a vertical trajectory. For example, the point $p_1$ will start moving downward for $t^+$ until it reaches a minimum from where it will start to move upwards again. Applying a sinusoidal current to the coil results in a standing wave in the air gap. The spatial mmf distribution has the form
\begin{equation}
  \label{eqn:F_theta_t_1}
  F(\theta,t) = \frac{4}{\pi}\frac{N_t }{2}\cos\theta \left(\hat{I}\cos \omega t\right)
\end{equation}
and will have nodes at $\frac{\pi}{2}$ and $\frac{3\pi}{2}$ while the anti-nodes will be at $0$ and $\pi$. Using a trigonometrical identity\footnote{$\cos A \cos B = \frac{1}{2}\cos(A-B)+\frac{1}{2}\cos(A+B)$} \eqref{eqn:F_theta_t_1} can be rewritten as the superposition of two rotating waves
\begin{equation}
  \label{eqn:F_theta_t_2}
  \begin{aligned}
  F(\theta,t) &= \frac{1}{2}\frac{4}{\pi}\frac{N_t }{2}\hat{I}\cos(\theta - \omega t)
  +\frac{1}{2}\frac{4}{\pi}\frac{N_t }{2}\hat{I}\cos(\theta + \omega t) \\
  &= F^+ + F^-
  \end{aligned}
\end{equation}
The result in \eqref{eqn:F_theta_t_2} means that a single coil produces two opposite rotating mmf waves in the air gap. In the next section this result is used to produce a single rotating mmf by displacing different coils in space. 

\subsection{The mmf of three single turn coils}
Producing a single rotating mmf wave using three coils means that each of the spatial mmf distribution functions must have a displacement for both the spatial and time component. Using \eqref{eqn:F_theta_t_2}, the resultant mmf for three coils will have the following form, i.e.
\begin{equation}
  \begin{aligned}
  F_R(\theta,t) &= (F_{1}^{+}+F_{1}^{-})+(F_{2}^{+}+F_{2}^{-})+(F_{3}^{+}+F_{3}^{-})\\
  &=(F_{1}^{+}+F_{2}^{+}+F_{3}^{+})+(F_{1}^{-}+F_{2}^{-}+F_{3}^{-})\\
  &=\sum_{n=1}^{3}F_{n}^{+}+\sum_{n=1}^{3}F_{n}^{-}
  \end{aligned}
\end{equation}
In general, choosing an angle of $\frac{2\pi}{m}$ between two adjacent positive coil sides will cause the negative waves to be cancelled. Thus, the positive waves are added together; this results in a single rotating wave. For $m$-phases the functions defined by
\begin{equation}
  \label{eqn:F_theta_t_3}
  F_n(\theta,t)=\hat{F_n}\cos\left[\theta+\frac{2\pi(n-1)}{m}\right]
  \cos\left[\omega t +\frac{2\pi(n-1)}{m}\right], \quad 1 \leq n \leq m
\end{equation}  
will produce a rotating wave when supplied by three-phase currents that is phase shifted by $\frac{2\pi}{m}$ radians. Setting $m=1$ in \eqref{eqn:F_theta_t_3} will be the same as \eqref{eqn:F_theta_t_1}. The summation of $m$ functions given in \eqref{eqn:F_theta_t_3} simplifies to a single rotating mmf in the air gap. Using the trigonometric identity the resultant air gap mmf is
\begin{equation}
  \label{eqn:F_theta_t_4}
  \begin{aligned}
  F_R(\theta,t)&=\sum_{n=1}^{m}\hat{F_n}\cos\left[\theta+\frac{2\pi(n-1)}{m}\right]
  \cos\left[\omega t +\frac{2\pi(n-1)}{m}\right] \\
  &=\frac{1}{2}\sum_{n=1}^{m}\hat{F_n}\cos(\theta-\omega t)+
  \frac{1}{2}\sum_{n=1}^{m}\hat{F_n}
  \cos\left[\theta+\omega t+\frac{4\pi(n-1)}{m}\right] \\
  &=\frac{m}{2}\hat{F_1}\cos(\theta-\omega t)
  \end{aligned}
\end{equation} 
Therefore, the effect of displacing the positive coil sides of $m$-coils by $\frac{2\pi}{m}$ radians results in a single rotating mmf wave in the air gap which is $\frac{m}{2}$ times that of the first coil.

The preceding explanation of the rotating mmf wave is graphically shown in Fig.~\ref{fig:mmf_2}(a). Therefore, starting with a single coil as in
Fig.~\ref{fig:mmf_1}(a) means it is necessary to add two more coils. Using the positive coil side of $+1$ as reference, the adjacent positive coil side $+2$ is placed at $-\frac{2\pi}{3}$ radians clockwise from \num{+1}. Next, with \num{+2} as reference the next adjacent positive coil side is $-\frac{2\pi}{3}$ radians clockwise from $+2$. The returning coil sides of both coils is displaced at $+\pi$ electrical radians in space. Since the resultant mmf wave is rotating in a positive direction the sequence\footnote{The direction of placing the positive coil sides and the returning coil sides is arbitrary. When the convention as explained is used, it simplifies the code which automatically does the coil assignment.} will be 
\begin{equation}
  \label{eqn:phasebelt_sequence}
  \{+1,\ -2,\ +3,\ -1,\ +2,\  -3\} 
\end{equation}

\begin{figure}
	\centering
  \fontsize{9}{10}\selectfont
		\input{figs/f_mmf_2.tex}
  \caption{The fundamental spatial mmf distribution for a three-phase machine}
	\label{fig:mmf_2}
\end{figure}

Fig.~\ref{fig:mmf_2}(b) shows graphically the mmf's of the three coils with $N_t$-turns. These are obtained by setting $m=3$ and applying the following three-phase currents 
\begin{equation}
  \label{eqn:3ph_i}
  \begin{aligned}
   i_1 &= \hat{I}\cos\left(\omega t \right) \\
   i_2 &= \hat{I}\cos\left(\omega t +\frac{2\pi}{3}\right) \\
   i_3 &= \hat{I}\cos\left(\omega t +\frac{4\pi}{3}\right) \\
  \end{aligned}
\end{equation}
to the functions in \eqref{eqn:F_theta_t_3}. The resultant mmf will rotate in a counterclockwise direction. At $t=0$ $i_2=i_3=-\frac{1}{2}i_1$, meaning the mmf of $F_2$ and $F_3$ will be half of $F_1$. As time starts to increase, any point on $F_1$ will move downward while points on $F_2$ and $F_3$ will start moving in an upward direction. The points are marked $p_1$ through $p_3$ in the figure. Contrary to this, any point on the resultant mmf will start moving in the right direction (counter-clockwise) as indicated by point $p_4$. As time increases the resultant mmf rotates as shown in Fig.~\ref{fig:rotating_wave}. The fundamental mmf is shown at time equal to zero and a time instant $t=t_1$.
\begin{figure}
	\centering
		\input{figs/f_mmf_rotation.tex}
	\caption[Rotation of the resultant mmf]{Rotation of the resultant mmf by displacing~%
	the three positive coil sides along the stator periphery}
	\label{fig:rotating_wave}
\end{figure}

\subsection{Definition of the mmf envelope functions}\label{subsec:mmf_def}
As time continues, any point on the standing wave will have a minimum and maximum value between which it oscillates. If $p_2$ is used as an example, it will be bounded as shown in Fig.~\ref{fig:mmf_2}(b), thus forming an envelope. Similarly, the remaining phases will each form envelope functions. The bounding functions for all the phases are given by
\begin{equation}
  \label{eqn:f_bound}
  f_n(\theta) = \hat{F_n}\cos\left[\theta+\frac{2\pi}{m}(n-1) \right], 
  \quad 1 \leq n \leq m
\end{equation}
and the mmf of any of the phases will be bounded, i.e. 
\begin{equation}
  -\left|f_n(\theta)\right| \leq F_n(\theta ,t) \leq \left|f_n(\theta)\right|
\end{equation}

\subsection{Phase belt definition}\label{subsec:phasebelt_def}
The mmf envelope functions in section \ref{subsec:mmf_def} allow the definition of the phase belt in a unique way, which make it possible to allocate the stator slots that belong to a phase before the coil sides are assigned. 
\begin{defth}
In general, the interval $\left\langle \theta_1,\theta_2 \right\rangle$ for which any of the $m$ bounding functions in \eqref{eqn:f_bound} is greater than the remaining $(m-1)$ functions is defined as a phase belt, i.e. 
\begin{equation}
 \left|f_i(\theta)\right| > \left|f_n(\theta)\right|, \quad
 \begin{cases}
   1 \leq n \leq m \\
   n \neq i
 \end{cases}
\end{equation}
and the interval $\left\langle \theta_1,\theta_2 \right\rangle$ spans $\frac{2\pi}{2m}$ radians. 
\end{defth}
A useful parameter to define is the total number of phase belts around the air gap periphery, i.e. 
\begin{equation}
  \label{eqn:Np}
  N_p = \frac{2\pi p}{\left(\frac{2\pi}{2m}\right)}=p\cdot2m
\end{equation}
and means that the phase belt sequence (for three phases) given in \eqref{eqn:phasebelt_sequence} repeat itself $p$ times around the air gap periphery.

\subsection{Higher order harmonics}
A similar procedure as for the working harmonic can be used to derive the direction of rotation for the higher order harmonics. The decomposition of the air gap mmf means that the resultant mmf is the sum of an infinite number of rotating waves. The general expression for harmonic order (for three phases and six phase belts) of the air gap mmf harmonics is
\begin{equation}
  \label{eqn:harm_oder}
  \nu = 1+6g \quad g=0,\mp1,\mp2,\ldots
\end{equation}
and the speed of rotation is given by 
\begin{equation}
  \omega_{\nu} = \frac{\omega}{\nu}
\end{equation}
A positive value of $\nu$ means that the harmonic is rotating counter-clockwise and a negative $\nu$ means it rotates clockwise. This convention is valid for the coil arrangement as given in Fig.~\ref{fig:mmf_2}(a) and the currents in \eqref{eqn:3ph_i}. The rotation speed is proportional to the inverse of the harmonic order.

\section{Matrix representation of a winding}
In this section it will be shown that the winding layouts can be represented by means of two matrices. The first matrix will contain information on the ingoing coil sides of the coils while the second matrix will be that of the outgoing coil sides. The matrices are referred to as $\mathbf{M_1}$ and $\mathbf{M_{2}}$ for the ingoing and outgoing coil sides respectively. Both matrices have $n$ columns and $m$ rows. In addition, the number of columns equals the number of stator slots and the rows are equal to the number of phases, thus $m=m$\footnote{It is typical in mathematics that the number of rows is represented by $m$. Equally the number of phases of an electrical machine is also represented by $m$. Furthermore, $m_{11}$ is a matrix element while $m$ is the number of phases.} and $n=Q_s$. The matrices can be expressed as
\begin{equation}
  \label{eqn:M_matrix}
  \mathbf{M_1} = \left[
  \begin{array}{cccc}
     m_{11} & m_{12} & \ldots & m_{1n}\\
     m_{21} & m_{22} & \ldots & m_{2n}\\
     \vdots & \vdots & \ddots & \vdots\\
     m_{m1} & m_{m2} & \ldots & m_{mn}\\
  \end{array} \right]
  \quad
  \mathbf{M_2} = \left[
  \begin{array}{c c c c}
     m_{11} & m_{12} & \ldots & m_{1n}\\
     m_{21} & m_{22} & \ldots & m_{2n}\\
     \vdots & \vdots & \ddots & \vdots\\
     m_{m1} & m_{m2} & \ldots & m_{mn}\\
  \end{array} \right]  
\end{equation}
where
\begin{equation}
  \label{eqn:cij_set}
  m_{ij} \in \left\{-1,0,1\right\}
\end{equation}
and depends on the winding layout. In the rest of this section an algebraic method is derived to determine the matrix elements. The variables $n_1$ and $n_2$ are integers and will be used as loop variables later on in this chapter where the algorithm flowchart is explained. The subscripts $1$ and $2$ refer to the outer and inner loop respectively. 

\subsection{Slot vector}
For assigning the $Q_s$ slots to phase belts, the peripheral slot angle $\alpha$ needs to be defined in terms of the slot pitch $\tau_s$. If the slots have a regular distribution the angle between any two adjacent slots equals $\tau_s$. In the case of irregular distributed slots the average slot pitch will equal $\tau_s$. A regular and irregular distribution are shown in Fig.~\ref{fig:f_slotstar}. A vector is assigned to the centre of each stator slot. The exponential representation\footnote{Also known as Euler's formula.} of a vector is used, i.e.
\begin{equation} 
  e^{j\nu \alpha}=\cos(\nu \alpha)+j\sin(\nu \alpha)
\end{equation}
The variables $\nu$ and $\alpha$ are the harmonic order and slot peripheral angle respectively. All the vectors as shown in Fig.~\ref{fig:f_slotstar} are represented as a column matrix $\mathbf{v_{\nu}}$. The number of rows is equal to the number of slots, i.e.
\begin{equation}
  \label{eqn:slot_vector}
  \mathbf{v_{\nu}}=\left[
                         e^{j\nu\alpha_1} 
                         \: 
                         e^{j\nu\alpha_{n_2}} 
                         \:
                         \ldots 
                         \: e^{j\nu\alpha_{Q_s}}
                    \right]^{T}
   \qquad 1 \leq n_2 \leq Q_s                 
\end{equation}
where
\begin{equation}
  \label{eqn:slot_alpha}
  \alpha_{n_2} = \left\{ \begin{array}{lll}
	  \tau_s\left(n_2-1\right) && n_2 \;\text{odd}\\
	  \alpha_{n_2-1}+x\tau_s & 0<x<2 & n_2\;\text{even}
	\end{array} \right.
	\quad
	1 \leq n_2 \leq Q_s
\end{equation}
where the $\alpha$ accounts for both regular and irregular distributed stator slots. Setting $\nu=p$ means that the electrical slot angles\footnote{The electrical and mechanical slot have the following relationship: $\theta_e=p \theta_m$} for the working harmonic are obtained. 
\begin{figure}
	\centering
		\input{figs/f_slotstar.tex}
	\caption{Star of slots}
	\label{fig:f_slotstar}
\end{figure}

\subsection{Phase belt constraint}
The phase belt constraint is used to determine the matrix elements $m_{ij}$ in \eqref{eqn:M_matrix}. From the slot angle $\alpha$ in \eqref{eqn:slot_vector} the corresponding electrical angle $\theta_e$ is obtained. A stator slot is assigned to the phase belt if the following constraint is true:
\begin{equation}	
 \label{eqn:phase_belt_constraint}
  \theta_1 \leq \theta_e  < \theta_2
  \quad
  \begin{cases}
    \left.
      \begin{array}{l}
        \theta_1 = \frac{2\pi}{2m}\left(n_1-1\right) \\
        \theta_2 = \frac{2\pi}{2m}n_1 \\
        1 \leq n_1 \leq N_p \\      
      \end{array}
    \right\} 
    \quad \mbox{phase belt boundaries} \\
    \left.
      \begin{array}{l}
        \theta_e = p\alpha_{n_2} \\
        1 \leq n_2 \leq Q_s \\      
      \end{array}    \right\} 
    \quad \mbox{electrical slot angle} \\
  \end{cases}
\end{equation} 
The phase belt constraint as given in \eqref{eqn:phase_belt_constraint} is characterised by the phase belt boundaries and the electrical slot angle, which are summerised as follows:
\begin{description}
	\item[Phase belt boundaries:] The total number of phase belts around the air gap~%
	periphery is given by \eqref{eqn:Np}. Each of the phase belts is bounded the by~%
	the angles $\theta_1$ and $\theta_2$.
	\item[Electrical slot angle:] The electrical slot angle is obtained by multiplying~%
	the peripheral slot angle in \eqref{eqn:slot_alpha} by the pole pair number. If~%
	the electrical angle for a given slot lies within the phase belt boundaries, it~%
	belongs to that phase belt.   
\end{description}
In order to assign the slot to a phase, it is necessary to know to which phase a given phase belt belongs. The phase can be determined in terms of the given phase belt number $n_1$ and the number of phases, i.e.
\begin{equation}
  \label{eqn:phase_belt_number}
  k = \mbox{mod}(n_1,2m)
  \quad
  \begin{cases}
    1 \leq n_1 \leq \ N_p \\
    2m \ \mbox{if} \ \mbox{mod}(n_1,2m)=0 \\
  \end{cases}
  \quad
  1\leq k \leq 2m
\end{equation}  
The value of $k$ as calculated in \eqref{eqn:phase_belt_number} corresponds to the phase belt number. Therefore, if the number of a given phase belt is known, the corresponding phase and its sign are calculated as follows:
\begin{equation}
  \label{eqn:phase_belt_number_2}
  \begin{aligned}
  \mbox{phase}&= 
    \left\{
    \begin{array}{ll}
	    k   & k \leq m\\
	    k-m & k > m
	  \end{array}
	  \right.
	  \\
	\mbox{sign}&=(-1)^{(k-1)} 
  \end{aligned}
\end{equation}	
If $m=3$ and $p=1$ the number of phase belts equals 6. Applying \eqref{eqn:phase_belt_number} and \eqref{eqn:phase_belt_number_2} will result in the phase belt sequence as given in \eqref{eqn:phasebelt_sequence}. 

\subsection{Algorithm flowchart}
The explanation of the algorithm is accompanied by the flowchart in Fig.~\ref{fig:flowchart} and greatly simplifies the understanding. For convenience the relevant equations or tables are included which makes it easier to follow the description. The algorithm only applies to symmetrical windings and the three major parts are summerised as follows:
\begin{description}
	\item[Outer loop:] The outer loop of the flowchart is used for the total number of phase belts as given in \eqref{eqn:Np}. The loop index $n_1$ (in the range $1\leq n_1 \leq N_p$) is used to calculate the given phase belt boundaries $\theta_1$ and $\theta_2$ as given in \eqref{eqn:phase_belt_constraint}. Since the $2m$ phase belts repeat themselves along the air gap periphery, the actual phase belt number $k$ in the phase belt sequence can be determined from $n_1$ as given in \eqref{eqn:phase_belt_number} and \eqref{eqn:phase_belt_number_2}.
	\item[Inner loop:] The inner loop has $n_2$ as index and is used to calculate the electrical angle for a given slot. If a slot is already assigned to a phase belt, the winding matrix will have an entry in the set $\{-1,1\}$. In this case the loop is skipped.   
	\item[Phase belt constraint:] This is the key step to allocate a stator slot. If the electrical angle lies within the phase belt boundaries, it belongs to the given phase belt. The row and column number for the ingoing matrix $\mathbf{M_1}$ are determined from the inner loop index $n_2$ and the given phase belt number. The row number for $\mathbf{M_2}$ is the same as for $\mathbf{M_1}$ and the column number is obtained from the coil pitch $y_d$.
\end{description}
The assignment of the stator slots as offered in this dissertation is unique and not presented in this way by any of the references consulted. 
\begin{figure}
	\centering
  \fontsize{9}{10}\selectfont
	\input{figs/f_flowchart.tex}
	\caption{Flowchart to allocate the stator slots}
	\label{fig:flowchart}
\end{figure}

\subsection{Matrix element assignment}\label{sec:m_assignment}
Once the phase belt constraint is fulfilled, the slot is allocated and the next step is to assign one of the values in the set given in \eqref{eqn:cij_set}. Actually only the sign needs to be determined. Since the phase belt sequence is alternating, the sign can be obtained from the phase belt itself. Following the flowchart through to the point where the test is performed, it is noticed that the matrix column number for $\mathbf{M}_1$ is given by the loop index variable $n_2$. The entry has the value  $(-1)^{(k-1)}$, where $k$ is given in \eqref{eqn:phase_belt_number}. The determination of the row, column and matrix element are summerised as follows\footnote{The method was only tested for $m=3,5,7,\ldots$}: 
\begin{equation}
  \label{eqn:matrix_element}
  \begin{aligned}
  i &= 
  \left\{ 
    \begin{array}{ll}
	    k   & k \leq m\\
	    k-m & k > m
	  \end{array}
	  \qquad 
	\right\}
	\mbox{row number}
	\\
	h &= (-1)^{(k-1)} 
	\quad 
	\mbox{matrix element sign} 
	\\
	j &= 
  \left\{ 
    \begin{array}{ll}
	    n_2+y_d   & n_2+y_d \leq Q_s \\
	    \mbox{mod}\bigl((n_2+y_d),Q_s\bigr) & n_2+y_d > Q_s
	  \end{array} 
	  \quad
	\right\}
	\mbox{column number}
	\end{aligned}
\end{equation}

\section{Properties of the winding matrix}
Presenting the winding in matrix form is very compact and has advantages in machine analysis. The matrix contains all the information of the winding arrangement in the stator slots. This allows the construction of the voltage phasor which is necessary to calculate the winding factor. In addition, the slot mmf can be obtained from the column data. The properties of the matrix are summerised as follows:
\begin{itemize}
	\item if the winding is symmetrical, the number of assigned elements in all~%
	the rows are equal;
	\item the number of columns is equal to the number of stator slots;
	\item the number of rows is equal to the number of phases;
	\item for a single layer winding there is only one nonzero element in a column;
	\item a double layer winding has two nonzero elements in a row; and
	\item the matrix is valid for both a fixed and variable slot pitch.
\end{itemize}
In the rest of this section the winding matrix is used to calculate the winding factor and the slot mmf.

\subsection{Winding factor}
With $\mathbf{M}_1$ and $\mathbf{M}_2$ assigned, the winding factor for any harmonic can be calculated as the product between the matrices and the slot vector as given in \eqref{eqn:slot_vector}. This means that a row of the winding matrix is multiplied by the slot vector column matrix. The matrix product means that all the vectors belonging to the same phase are added and for the case $\nu=p$ equals
\begin{equation}
  \label{eqn:m1_m2_exp}
  (m_{1,i1}+m_{2,i1})e^{jp\alpha_1}+(m_{1,i2}+m_{2,i2})e^{jp\alpha_2}+\ldots+
  (m_{1,iQ_s}+m_{2,iQ_s})e^{jp \alpha_{Q_s}}
\end{equation}
If the slot vector does not belong to the current phase, the coefficient
\begin{equation} 
  \left(m_{1,ij}+m_{2,ij}\right)
\end{equation} 
is zero. Furthermore, the product should be normalised. Since the total number of vectors is related to the coils per phase it should be multiplied by $\left(2\frac{Q_c}{m}\right)^{-1}$, i.e.
\begin{equation}
  \label{eqn:winding_factor}
  \xi_{\nu} = \frac{m}{2Q_c}
  \Bigl[
    \mathbf{M}_1\mathbf{v_{\nu}}+\mathbf{M}_2\mathbf{v_{\nu}}
  \Bigr], 
  \quad \in \mathbb{C}
\end{equation}
The result \eqref{eqn:winding_factor} present the winding factor as a complex number and the absolute value is to be used as a reduction factor for the sinusoidally induced voltage in \eqref{eqn:ui}. Writing $\xi_{\nu}$ as
\begin{equation}
  \xi_{\nu} = a_{\nu}+jb_{\nu}
\end{equation}
the phase angle is calculated as 
\begin{equation}
  \theta_{\nu} = \arctan\left(\frac{b_{\nu}}{a_{\nu}}\right)
\end{equation}
The phase angle (in electrical radians) gives information on the position of the winding axes\footnote{The winding axes in the present dissertation refer to the current anti-node axis and the magnetic axis. This is shown in Fig.~\ref{fig:determ_axis}.} relative to the first slot. The two winding axes associated with each phase are called
\begin{itemize}
	\item the current sheet anti-node axis and
	\item the magnetic axis
\end{itemize}
of the winding. A positive phase angle means that both winding axes have moved clockwise with respect to the first slot. The winding axes are a very import quantities in machine design. When the machine is supplied with a source, a rotating magnetic flux wave is generated. This reacts with the flux generated by the flux of the permanent magnets on the rotor. In order to control the resultant flux, it is necessary to know the exact position of the winding axes.  

\subsection{Current sheet anti-node axis}\label{subsec:current_sheet}
Equation \eqref{eqn:F_theta_t_1} describes the space fundamental component of the mmf produced by the current in phase 1. It can be seen as the mmf wave produced by a finely divided sinusoidally distributed current sheet placed on the inner periphery of the stator. The position of the anti-node with maximum deviation is given by $\theta_{an}$. The relative position of $\theta_{an}$ with respect to the first slot is given by
\begin{equation}
  \label{eqn:theta_an}
  \theta_{an_{\nu}} = -
  \frac{\theta_{\nu}}{p}
\end{equation} 

\subsection{Magnetic axis}\label{subsec:magnetic_axis}
The axis along which the flux is directed when current is flowing in the coil, is defined as the magnetic axis. This is the same position where the current sheet has a node. The relative position of the magnetic axis $\theta_m$ with respect to the first slot is given by
\begin{equation}
  \label{eqn:theta_m}
  \theta_{m_{\nu}} = -
  \frac{\left(\theta_{\nu}+\frac{\pi}{2}\right)}{p}
\end{equation} 
The winding magnetic axis lags the current sheet anti-node axis by $\frac{\pi}{2}$
radians.

\subsection{Slot mmf}\label{subsec:slot_mmf}
The amp\`ere-turns in each slot can be obtained from the matrix winding columns. Both the matrices $\mathbf{M_1}$ and $\mathbf{M_2}$ contain the coil side information for the ingoing and outgoing coil sides respectively. The total amp\`ere-turns of a coil side is the product of its value in the winding matrix with the number of coil turns $N_t$. The direction of the current is given by the sign of the element. Therefore to get the total amp\`ere-turns in the slot, the amp\`ere-turns of the coil sides must be added. For a three-phase winding the slot mmf $F_{slot}$ of the $k^{th}$ slot is calculated as  
\begin{equation}
  \label{eqn:slot_mmf}
  \begin{aligned}
  F_{slot,k} &= N_t i_1(m_{1,1k}+m_{2,1k})+
                N_t i_2(m_{1,2k}+m_{2,2k})+
                N_t i_3(m_{1,3k}+m_{2,3k}) \\
             &= N_t\sum_{n=1}^{3}i_n \left(m_{1,nk}+m_{2,nk}\right) 
  \end{aligned}
\end{equation}

\section{Examples}
The derived theory presented in this chapter is now illustrated by means of examples. The examples are summerised as follows:
\begin{description}
	\item[Winding factor tables:] The winding factors for different slot and pole pair combinations are calculated for single and double layer non-overlapping windings. The results presented are used to derive an expression to find the feasible range for the number of pole pairs, given the number of stator slots. 
	\item[Slot mmf and current sheet:] The prototype stator with 30 slots is used as an example. By choosing different pole pair numbers, it is shown how to obtain both a single and double layer winding. In each case a non-overlapping and overlapping winding are explained.
\end{description}
  
\subsection{Winding factor table}\label{subsec:wind_fac_table}
The results are given in Tab.~\ref{tab:xi_single} Tab.~\ref{tab:xi_double} for single and double layer non-overlapping windings respectively. Only those slot and pole combinations for which the winding factor is greater than or equal to $\frac{\sqrt{3}}{2}$ are given. Those combinations that do not fulfill the condition in \eqref{eqn:feasibility} are marked as not applicable. Presenting the winding factors in a table is helpful to identify the relationship between the number of stator slots and the number of poles which results in the best combinations. Only the winding factors for the working harmonic are presented. 

The winding factors for single windings are calculated for pole pairs in the range from 4 to 28, whereas the number of stator slots range from 12 to 84. Although the focus in the present dissertation is on single layer non-overlapping windings, the winding factors for double layer windings are given as well. The winding factors are calculated for pole pairs in the range from 4 to 16, whereas the number of stator slots ranges from 12 to 48.
\begin{table}[htbp]
	\caption{$\xi_p \times \num{e-3}$ for single layer non-overlapping windings}
	\label{tab:xi_single}
	\centering
	 \begin{tabular}
		{|l||c|c|c|c|c|c|c|c|c|c|c|c|c|}\cline{2-14}
		\multicolumn{1}{c}{}& \multicolumn{13}{|c|}{$Q_s$}
		\\\hline
		$p$&12 &18 &24 &30 &36 &42 &48 &54 &60 &66 &72 &78 &84  \\\hline
		4  &866&   &   &   &   &   &   &   &   &   &   &   &    \\
		5  &966&   &   &   &   &   &   &   &   &   &   &   &    \\
		6  &na &866&   &   &   &   &   &   &   &   &   &   &    \\
		7  &966&902&   &   &   &   &   &   &   &   &   &   &    \\
		8  &866&945&866&   &   &   &   &   &   &   &   &   &    \\
		9  &   &na &na &   &   &   &   &   &   &   &   &   &    \\
		10 &   &945&966&866&   &   &   &   &   &   &   &   &    \\
		11 &   &902&958&874&   &   &   &   &   &   &   &   &    \\
		12 &   &866&na &na &866&   &   &   &   &   &   &   &    \\
		13 &   &   &958&940&870&   &   &   &   &   &   &   &    \\
		14 &   &   &966&950&na &866&   &   &   &   &   &   &    \\
		15 &   &   &na &na &966&na &   &   &   &   &   &   &    \\
		16 &   &   &866&950&na &na &866&   &   &   &   &   &    \\
		17 &   &   &   &940&956&na &859&   &   &   &   &   &    \\
		18 &   &   &   &na &na &na &na &866&   &   &   &   &    \\
		19 &   &   &   &866&956&na &907&na &   &   &   &   &    \\
		20 &   &   &   &866&na &na &966&na &866&   &   &   &    \\
		21 &   &   &   &   &966&na &na &na &na &   &   &   &    \\
		22 &   &   &   &   &na &na &958&na &954&866&   &   &    \\
		23 &   &   &   &   &870&na &956&na &893&na &   &   &    \\
		24 &   &   &   &   &866&na &na &na &na &na &866&   &    \\
		25 &   &   &   &   &   &na &956&na &966&na &848&   &    \\
		26 &   &   &   &   &   &na &958&na &na &na &870&866&    \\	
		27 &   &   &   &   &   &na &na &na &na &na &na &na &    \\	
		28 &   &   &   &   &   &866&966&na &na &na &na &na &866 \\\hline			
	\end{tabular}
\end{table}
 
\begin{table}[htbp]
	\caption{$\xi_p \times \num{e-3}$ for double layer non-overlapping windings }
	\label{tab:xi_double}
	\centering
  \begin{tabular}
		{|l||c|c|c|c|c|c|c|c|c|c|c|c|c|}\cline{2-14}
		\multicolumn{1}{c}{}& \multicolumn{13}{|c|}{$Q_s$}
		\\\hline
		$p$&12 &15 &18 &21 &24 &27 &30 &33 &36 &39 &42 &45 &48  \\\hline
		4  &866&   &   &   &   &   &   &   &   &   &   &   &    \\
		5  &930&866&   &   &   &   &   &   &   &   &   &   &    \\
		6  &na &na &866&   &   &   &   &   &   &   &   &   &    \\
		7  &930&950&900&866&   &   &   &   &   &   &   &   &    \\
		8  &866&950&950&890&866&   &   &   &   &   &   &   &    \\
		9  &   &na &na &na &na &866&   &   &   &   &   &   &    \\
		10 &   &866&950&950&930&880&866&   &   &   &   &   &    \\
		11 &   &   &900&950&950&920&870&866&   &   &   &   &    \\
		12 &   &   &866&na &na &950&na &na &866&   &   &   &    \\
		13 &   &   &   &890&950&950&940&900&870&866&   &   &    \\
		14 &   &   &   &866&930&950&950&930&900&860&866&   &    \\
		15 &   &   &   &   &na &950&na &na &930&na &na &866&    \\
		16 &   &   &   &   &866&920&950&950&950&920&890&860&866 \\\hline			
		\end{tabular}
\end{table}

From the results in Tab.~\ref{tab:xi_single} and Tab.~\ref{tab:xi_double} the number of slots per pole and phase which results in a winding with suitable winding factors is given by
\begin{equation}
  \frac{1}{4} \leq q \leq \frac{1}{2}
\end{equation}
The result is the same as presented by \cite{REF-00754} and \cite{REF-00756}. Using this result, the range of pole pairs for a given number of slots can be expressed as follows:
\begin{equation}
  \frac{Q_s}{m} \leq p \leq \frac{2Q_s}{m}
  \quad
  \left\{
  \begin{array}{ll}
  Q_s \in \left\{6,12,18,\ldots\right\} & \mbox{single layer}\\
  \:  & \: \\
  Q_s \in \left\{3,6,9,\ldots\right\} & \mbox{double layer}\\
  \end{array}
  \right.
\end{equation} 

\subsection{Slot mmf and current sheet}
This section entails examples of overlapping and non-overlapping windings with 30 stator slots. The classification parameters $q$, $q_c$ and $y_d$ (as given in Tab.~\ref{tab:Example_table}) are used to classify the windings according to the scheme in Fig.~\ref{fig:classification}. Additionally, for the selected number of pole pairs the winding factor, slot mmf and current sheet are calculated. It is important to mention that the choice of the position of the reference slot will determine the rotation direction of the resulting rotating field. It is desirable to have a field rotating in a counter-clockwise direction, since this is the positive direction in a polar coordinate system. To achieve this, the stator is rolled flat with the top part of the slots facing upwards. 
\begin{table}[htbp]
	\caption{Different pole pair combinations with $Q_s = 30$}
	\label{tab:Example_table}
	\centering	
	 \begin{tabular}{ccccccccccccccccc}
	  \toprule
		$Q_s$ &$p$ &$Q_c$ &$n_l$& $y_p$ &$y_d$ &$q$ &$q_c$ & $Q_b$ & $t$ &
		$\xi_p$ &$\xi_{5p}$ &$\xi_{7p}$ &Figure
		\\
		\midrule
		30    &10  &15  &1   &$\frac{3}{2}$   &1   &$\frac{1}{2}$ &  $\frac{1}{4}$& 6 & 5 &
		0.866   &0.866      &0.866      &%
		\ref{fig:Main_non-overlapping_single}\subref{fig:f_Qs30_p10_1}
		\\
		30    &10  &30  &2    &$\frac{3}{2}$  &1   &$\frac{1}{2}$ &  $\frac{1}{2}$ & 3&10 &
		0.866   &0.866      &0.866      &%
		\ref{fig:Main_non-overlapping_double}\subref{fig:f_Qs30_p10_2}
		\\    
		30    &5   &15  &1    &3 &3  &1 &  $\frac{1}{2}$ & 6 & 5  &
		1.0     &1.0        &1.0        &%
		\ref{fig:Main_single_overlapping}\subref{fig:f_Qs30_5_1}
		\\
		30    &5   &30  &2    &3 &3  &1 &  1 & 6 & 5  &
		1.0     &1.0        &1.0        &%
		\ref{Main_double_overlapping}\subref{fig:f_Qs30_p5_2}   
		\\
		\bottomrule			
	 \end{tabular}
\end{table} 

\subsubsection{Single layer non-overlapping}
Fig.~\ref{fig:Main_non-overlapping_single}\subref{fig:single_layer} shows an illustration of a single layer non-overlapping winding. There is only one coil side in each stator slot and the slot pitch could be either regular or irregular. An irregular slot pitch means that the coil pitch can be varied to improve the winding factor. Depending on the design criteria, it can also be used to improve the torque ripple. Since the outgoing coils are given by the coil pitch $y_d$, only every second slot needs to be assigned to a phase belt.  

The example chosen is that of the prototype machine with 30 slots and 10 pole pairs. 
From Tab.~\ref{tab:Example_table} the values for $q$ and $q_c$ are $\frac{1}{2}$ and $\frac{1}{4}$ respectively. The basic winding is determined using $q_c$ and has one  coil per phase distributed over 4 poles. In total the basic winding has 6 slots. The winding has a sub-harmonic with 5 pole pairs. Since it is a single layer winding the number of coils is half the number of stator slots. The coil pitch equals one and this is a fractional slot winding. For convenience only the basic winding matrix elements for $\mathbf{M_1}$ and $\mathbf{M_2}$ are given as
\begin{equation}
  \mathbf{M_{1,b}} = 
  \begin{pmatrix}
  1&0&0&0&0&0\\
  0&0&1&0&0&0\\
  0&0&0&0&1&0\\
  \end{pmatrix} \
  \mathbf{M_{2,b}} = 
  \begin{pmatrix}
  0&-1&0&0 &0&0 \\
  0&0 &0&-1&0&0 \\
  0&0 &0&0 &0&-1\\
  \end{pmatrix} 
\end{equation}
To obtain the complete winding matrix, the matrix of the basic winding is repeated five times. For the ingoing coil side matrix this means
\begin{equation}
  \mathbf{M_1} = 
  \begin{bmatrix}
  \mathbf{M_{1,b}}&\mathbf{M_{1,b}}&\mathbf{M_{1,b}}&
  \mathbf{M_{1,b}}&\mathbf{M_{1,b}}
  \end{bmatrix}  
\end{equation}
The winding matrix is used to obtain the slot mmf $F_{slot}$ from \eqref{eqn:slot_mmf} as shown in the lower part of~%
Fig.~\ref{fig:Main_non-overlapping_single}\subref{fig:f_Qs30_p10_1}. The dashed line in the mmf plot is the current sheet. In the top part of the figure the winding factors are shown as well. From the figure it is clear that the winding factors are periodic with the number of stator slots. In the example the peripheral slot angle was calculated setting $x=1$ in \eqref{eqn:slot_alpha}. Therefore, this is a regular distribution of the stator slots.
\begin{figure}[htbp]
	\centering
	\input{figs/f_single_layer.tex}
	\vspace{1cm}
	\input{figs/f_Qs_30_p_10_1.tex}
	\caption{Non-overlapping single layer winding}
	\label{fig:Main_non-overlapping_single}
\end{figure}

\subsubsection{Double layer non-overlapping}
Fig.~\ref{fig:Main_non-overlapping_double}\subref{fig:dlw_yd_eq_1} shows a non-overlapping double layer winding. Each stator slot has two coil sides. Moreover, each slot needs to be assigned to a phase belt. 

The prototype stator with 30 slots is used with 10 pole pairs. This is a double layer winding and the number of slots is equal to the number of coils. Both $q$ and $q_c$ and the basic winding has 3 slots. The lowest harmonic has 10 pole pairs which is the same as the working harmonic. Therefore, the winding has no sub-harmonics. The matrix elements of the basic winding are 
\begin{equation}
  \mathbf{M_{1,b}} = 
  \begin{pmatrix}
  1&0&0\\
  0&0&1\\
  0&1&0\\ 
  \end{pmatrix} \
  \mathbf{M_{2,b}} = 
  \begin{pmatrix}
  0 &-1&0\\
  -1&0&0\\
  0&0&-1\\ 
  \end{pmatrix} 
\end{equation}
The winding factors and slot mmf are directly obtained from the winding matrix as shown in Fig.~\ref{fig:Main_non-overlapping_double}\subref{fig:f_Qs30_p10_2}. The current sheet that corresponds to the working harmonic is included.
\begin{figure}[htbp]
	\centering
	\input{figs/f_double_layer_type2.tex}
	\vspace{1cm}
  \input{figs/f_Qs_30_p_10_2.tex}
	\caption{Non-overlapping double layer winding}
	\label{fig:Main_non-overlapping_double}
\end{figure}

\subsubsection{Single layer overlapping}
A general single layer overlapping winding is shown in~% 
Fig.~\ref{fig:Main_single_overlapping}\subref{fig:slw_yd_eq_1}. In this example the coil pitch equals 5. The ingoing coil side of the first coil is in slot 1 and the outgoing coil side in slot 6. It is clear from the figure that the coils overlap. 

The example to illustrate the slot mmf and current sheet has 30 slots and a pole pair number equal to 5. In Tab.~\ref{tab:Example_table} the average pole pitch equals the pole pitch. Therefore this is called a concentrated winding as determined from Fig.~\ref{fig:classification}. The basic winding matrix elements are given as
\begin{equation}
  \mathbf{M_{1,b}} = 
  \begin{pmatrix}
  1&0&0&-1&0&0\\    
  0&-1&0&0&1&0\\   
  0&0&1&0&0&-1\\   
  \end{pmatrix} \
  \mathbf{M_{2,b}} = 
  \begin{pmatrix}
  1& 0&0&-1&0&0\\
  0&-1&0& 0&1&0\\
  0& 0&1& 0&0&-1\\  
  \end{pmatrix} 
\end{equation}
The calculated winding factor along with the slot mmf and current sheet are shown in Fig.~\ref{fig:Main_single_overlapping}\subref{fig:f_Qs30_5_1}. It is important to mention that the coil sides are distributed in such a way as to obtain a sinusoidal slot mmf distribution. The number of slots per pole and phase can be increased to obtain a better sinusoidal distribution. In doing so, the harmonic content will become less.
\begin{figure}[htbp]
	\centering
	\input{figs/f_single_layer_type1.tex}
	\vspace{1cm}
	\input{figs/f_Qs_30_p_5_1.tex}
	\caption{Single layer overlapping winding}
	\label{fig:Main_single_overlapping}
\end{figure}

\subsubsection{Double layer overlapping}
A double layer overlapping winding is commonly used in industrial machines. Overlapping double layer windings have a coil pitch greater than one, i.e.~$y_d>1$. Fig.~\ref{fig:dlw_yd_gt_1} shows a double layer winding. Starting at the first slot, the coils are inserted in a counter-clockwise direction. The first coil has its ingoing coil side in the bottom part of slot 1 and the return coil side is in the top part of slot 6. The phase belt constraint in \eqref{eqn:phase_belt_constraint} is used to determine the phase of the coil side in the bottom part of the slot while the top coil sides are given by the coil pitch $y_d$.

Fig.~\ref{fig:f_Qs30_p5_2} shows the slot mmf of a stator with $Q_s=30$ slots and $p=5$ pole pairs. Using the winding properties for this combination given in Tab.~\ref{tab:Example_table}, it is a concentrated winding. The winding has no sub-harmonics. 
\begin{figure}[htbp]
	\centering
	\input{figs/f_double_layer.tex}
	\vspace{1cm}
	\input{figs/f_Qs_30_p_5_2.tex}
	\caption{Double layer overlapping winding}
	\label{Main_double_overlapping}
\end{figure}

\clearpage
\section{Summary}
In this report an algorithm was derived to present a winding in a matrix form. This compact form allows the calculation of the winding factors for all harmonics. The basis of the algorithm is the phase belt sequence and the phase belt constraint which are derived from the air gap mmf envelope functions. 

\appendix

\section{Slot assignment \texttt{CDesign.m}}\label{sec:malg}
\verbatiminput{../code/CDesign.m}

\section{Examples \texttt{arun.m}}\label{sec:mex}
\verbatiminput{../code/arun.m}

\begin{figure}[htbp]
\centering
\fontsize{8}{0}\selectfont
\setlength\fwidth{0.47\textwidth}
\subfloat{
\input{figs/fig6b.tex}}
\hfill
\setlength\fwidth{0.47\textwidth}
\subfloat{
\input{figs/fig7b.tex}}
\\
\fontsize{8}{0}\selectfont
\setlength\fwidth{0.47\textwidth}
\subfloat{
\input{figs/fig8b.tex}}
\hfill
\fontsize{8}{0}\selectfont
\setlength\fwidth{0.47\textwidth}
\subfloat{
\input{figs/fig9b.tex}}
\caption{Test results using \texttt{arun.m}}
\label{fig:tests}
\end{figure}